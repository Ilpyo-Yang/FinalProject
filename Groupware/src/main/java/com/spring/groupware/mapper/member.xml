<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="member">


	<select id="companyName_select" resultType="String">
		select com_name
		from tbl_company 
	</select>

	
	<select id="companyInfo_select" resultType="com.spring.groupware.member.model.CompanyVO">
		select com_name, com_address, registraion_num, business_type, com_ph, com_email
		from tbl_company 
	</select>

	
	<select id="ceoName_select" resultType="String">
		select mbr_name
		from tbl_mbr 
		where fk_rank_no=2
	</select>


	<select id="adminInfo_select" resultType="com.spring.groupware.member.model.MemberVO">
		select mbr_name, dept_detail, mbr_email, mbr_phone_number
		from 
		(        
		select mbr_name, fk_dept_no, mbr_email, mbr_phone_number, fk_power_no
		from tbl_mbr
		)A left join tbl_dept B
		on fk_dept_no = dept_no
		where fk_power_no=2
	</select>
	
	
	<select id="loginCheck" parameterType="HashMap" resultType="com.spring.groupware.member.model.MemberVO">
		select mbr_id, mbr_name, mbr_email, mbr_com_number, mbr_phone_number, mbr_birthday, mbr_stsmsg, mbr_stsconnect, mbr_img
		     , trunc((mbr_pwd_changeday-mbr_registerday)/30) as pwdChangeGap, nvl(mbr_photo,'0'), nvl(mbr_sign,'0'), rank_detail, power_detail, dept_detail
		from 
		(        
		select mbr_id, mbr_name, fk_power_no, fk_rank_no, fk_dept_no, mbr_email, mbr_com_number, mbr_phone_number, mbr_stsmsg, mbr_stsconnect, mbr_img
		     , mbr_birthday, mbr_pwd_changeday, mbr_photo, mbr_sign, mbr_pwd, mbr_status, mbr_registerday
		from tbl_mbr
		)A left join tbl_dept B
		on fk_dept_no = dept_no
		join tbl_rank CS
		on fk_rank_no = rank_no
		join tbl_power D
		on fk_power_no = power_no
		where mbr_id=#{id} and mbr_pwd=#{pwd} and mbr_status='1'
	</select> 
	
</mapper>